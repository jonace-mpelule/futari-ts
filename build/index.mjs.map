{"version":3,"file":"index.mjs","names":["id: string","uuidV4","uuidv5","router: Router | undefined","directories: Array<string>","fullPath: any","error: any","_: unknown","result: any","nConfig: Config","chalk","routes: Array<Route>","_: unknown"],"sources":["../src/constants/symbols.constants.ts","../src/decorators/route.decorators.ts","../src/utils/utils.ts","../src/constants/httpStatus.constants.ts","../src/events/eventemitter.config.ts","../src/events/apiEventLog.event.ts","../src/utils/body-parser.ts","../src/utils/runMiddleware.ts","../src/fn/handleServer.ts","../src/fn/createServer.ts","../src/fn/routeWrapper.ts"],"sourcesContent":["export const DEF_ROUTE_KEY = Symbol('def:route');\nexport const ROUTES_KEY = Symbol('routes');\nexport const MIDDLEWARE_KEY = Symbol('middlewares')","/** biome-ignore-all lint/suspicious/noExplicitAny: <'explanation'> */\n/** biome-ignore-all lint/correctness/noUnusedFunctionParameters: <'explanation'> */\n\nimport Reflet from \"reflect-metadata\";\nimport { v4 as uuidV4, v5 as uuidv5 } from \"uuid\";\nimport {\n    DEF_ROUTE_KEY,\n    MIDDLEWARE_KEY,\n    ROUTES_KEY,\n} from \"../constants/symbols.constants\";\nimport type { Context, Middleware, SubRoute } from \"../types/network\";\n\nexport const ROUTE_NAMESPACE = \"6ba7b811-9dad-11d1-80b4-00c04fd430c8\";\n\nconst _ = Reflet;\n\nexport function DefRoute() {\n\treturn (target: any) => {\n\t\t/**\n\t\t * Id to identify the class in case of colliding class names\n\t\t */\n\t\tconst id: string = uuidV4();\n\n\t\tReflect.defineMetadata(\n\t\t\tDEF_ROUTE_KEY,\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tisRouter: true,\n\t\t\t},\n\t\t\ttarget,\n\t\t);\n\t};\n}\n\nexport function Use(fn: (ctx: Context) => void) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tconst controller = target.constructor;\n\t\t/**\n\t\t * * Getting Class Metadata\n\t\t */\n\t\tconst defRouteData = Reflect.getMetadata(DEF_ROUTE_KEY, controller);\n\t\tconst middlewares =\n\t\t\t(Reflect.getMetadata(MIDDLEWARE_KEY, controller) as Array<Middleware>) ||\n\t\t\t[];\n\n\t\t/**\n\t\t * * Route x Attached Middleware Unique Id\n\t\t */\n\t\tconst handlerId = uuidv5(`${defRouteData?.id}:${key}`, ROUTE_NAMESPACE);\n\n\t\tmiddlewares.push({\n\t\t\tid: handlerId,\n\t\t\thandlerKey: key,\n\t\t\thandler: fn,\n\t\t});\n\n\t\tReflect.defineMetadata(MIDDLEWARE_KEY, middlewares, controller);\n\n\t\t// const handlerId = uuidv5(\n\t\t// \t`${controllerName}:GET:${path}:${key}`,\n\t\t// \tROUTE_NAMESPACE\n\t\t//   );\n\n\t\t// target.__middlewares.push({\n\t\t// \tid: handlerId,\n\t\t// \thandlerKey: key,\n\t\t// \thandler: fn,\n\t\t// });\n\t};\n}\n\nexport function Get(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tconst controller = target.constructor;\n\t\t/**\n\t\t * * Getting Class Metadata\n\t\t */\n\t\tconst defRouteData = Reflect.getMetadata(DEF_ROUTE_KEY, controller);\n\n\t\tconst routes =\n\t\t\t(Reflect.getMetadata(ROUTES_KEY, controller) as Array<SubRoute>) || [];\n\n\t\t/**\n\t\t * * Route Unique Id\n\t\t */\n\t\tconst handlerId = uuidv5(`${defRouteData?.id}:${key}`, ROUTE_NAMESPACE);\n\n\t\troutes.push({\n\t\t\tid: handlerId,\n\t\t\tmethod: \"GET\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t\tmiddlewares: [],\n\t\t});\n\n\t\tReflect.defineMetadata(ROUTES_KEY, routes, controller);\n\n\t\t// const classData = target.constructor.data;\n\n\t\t// console.log('Class data:', classData);\n\n\t\t// if (!target.__routes) target.__routes = [];\n\t\t// target.__routes.push({\n\t\t// \tmethod: \"GET\",\n\t\t// \tpath,\n\t\t// \thandlerKey: key,\n\t\t// });\n\t};\n}\n\nexport function Post(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"POST\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Put(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"PUT\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Patch(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"PATCH\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Delete(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"DELETE\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Head(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"HEAD\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Options(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"OPTIONS\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Connect(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"CONNECT\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n\nexport function Trace(path: string) {\n\treturn (target: any, key: string, descriptor?: PropertyDescriptor) => {\n\t\tif (!target.__routes) target.__routes = [];\n\t\ttarget.__routes.push({\n\t\t\tmethod: \"TRACE\",\n\t\t\tpath,\n\t\t\thandlerKey: key,\n\t\t});\n\t};\n}\n","import { readdir } from \"node:fs/promises\";\nimport path from \"node:path\";\nimport chalk from \"chalk\";\nimport signale from \"signale\";\nimport {\n\tDEF_ROUTE_KEY,\n\tMIDDLEWARE_KEY,\n\tROUTES_KEY,\n} from \"../constants/symbols.constants\";\nimport type {\n\tMiddleware,\n\tRequest,\n\tResponse,\n\tRouter,\n\tSubRoute,\n} from \"../types/network\";\n\nexport const checkRoutes = async (filePath: string) => {\n\tconst module = await import(filePath);\n\n\tif (typeof module.default !== \"function\") {\n\t\tsignale.log(\n\t\t\tchalk.red(\"Error:\"),\n\t\t\t`${filePath.split(\"/routes\")[1]} has no default class or +route.ts file is not defined`,\n\t\t);\n\t\tprocess.exit(1);\n\t}\n\n\t/**\n\t * * Gets constructor/class assigned metadata\n\t */\n\tconst router: Router | undefined =\n\t\tReflect.getMetadata(DEF_ROUTE_KEY, module.default) ?? undefined;\n\n\tif (!router || !router.isRouter) {\n\t\tsignale.log(\n\t\t\tchalk.bgRed(\"Error:\"),\n\t\t\t`${filePath.split(\"/routes/\")[1]} is not a valid router please attach '@DefRoute()' to the default class `,\n\t\t);\n\t\tprocess.exit(1);\n\t}\n};\n\nexport const processRoutes = async (filePath: string) => {\n\ttry {\n\t\tconst module = await import(filePath);\n\n\t\tconst routes =\n\t\t\t(Reflect.getMetadata(ROUTES_KEY, module.default) as Array<SubRoute>) ||\n\t\t\t[];\n\t\tconst middlewares =\n\t\t\t(Reflect.getMetadata(\n\t\t\t\tMIDDLEWARE_KEY,\n\t\t\t\tmodule.default,\n\t\t\t) as Array<Middleware>) || [];\n\n\t\t// const routes: Array<SubRoute> = data.__routes;\n\t\tfor (const mid of middlewares ?? []) {\n\t\t\tconst index = routes.findIndex(\n\t\t\t\t(e) => e.id === mid.id && e.handlerKey === mid.handlerKey,\n\t\t\t);\n\t\t\tif (index !== -1) {\n\t\t\t\troutes[index]?.middlewares.push(mid);\n\t\t\t}\n\t\t}\n\n\t\treturn routes;\n\t} catch (err) {\n\t\tconsole.log(\"proccess routes\", err);\n\t}\n};\n\nexport const runRoute = async ({\n\tfilePath,\n\thandlerKey,\n\treq,\n\tres,\n}: {\n\tfilePath: string;\n\thandlerKey: string;\n\treq: Request;\n\tres: Response;\n}) => {\n\tconst module = await import(filePath);\n\tif (typeof module.default !== \"function\") {\n\t\tthrow new Error(\"Default export is not a function\");\n\t}\n\n\treturn new module.default()[handlerKey](req, res);\n};\n\nexport const runDefault = async (filePath: string) => {\n\tconst module = await import(filePath);\n\tif (typeof module.default !== \"function\") {\n\t\tthrow new Error(\"Default export is not a function\");\n\t}\n\treturn module.default();\n};\n\nexport async function getDirectoryPathsRecursive(dirPath: string) {\n\tlet directories: Array<string> = [];\n\n\ttry {\n\t\tconst entries = await readdir(dirPath, { withFileTypes: true });\n\n\t\tfor (const entry of entries) {\n\t\t\tconst fullPath: any = path.join(dirPath, entry.name);\n\n\t\t\tif (entry.isDirectory()) {\n\t\t\t\t// Add the current directory path to the list\n\t\t\t\tdirectories.push(fullPath);\n\n\t\t\t\t// Recurse into this subdirectory and merge the results\n\t\t\t\tdirectories = directories.concat(\n\t\t\t\t\tawait getDirectoryPathsRecursive(fullPath),\n\t\t\t\t);\n\t\t\t}\n\t\t\t// Files are ignored in this version\n\t\t}\n\t} catch (error: any) {\n\t\t// console.error(`Error reading directory ${dirPath}:`, error.message);\n\t\t// Depending on your needs, you might want to throw the error\n\t}\n\n\treturn directories;\n}\n\n/**\n * @description Resolves if port is alreadt in use or not\n * @param port\n * @returns {isInUse: boolean, err?: string | null}\n */\nexport async function isPortAvailable(\n\tport: number,\n): Promise<{ isInUse: boolean; err?: string | null }> {\n\tconst portUsed = await import(\"tcp-port-used\");\n\n\treturn new Promise((resolve, reject) => {\n\t\tportUsed.check(port, \"127.0.0.1\").then(\n\t\t\t(inUse) => {\n\t\t\t\tresolve({ isInUse: inUse });\n\t\t\t},\n\t\t\t(err) => {\n\t\t\t\treject(err.message);\n\t\t\t},\n\t\t);\n\t});\n}\n","/**\n * * List of Http Statuses\n */\nexport const HTTP_STATUS = {\n\t// 1xx Informational\n\tCONTINUE: 100,\n\tSWITCHING_PROTOCOLS: 101,\n\tPROCESSING: 102,\n\tEARLY_HINTS: 103,\n\n\t// 2xx Success\n\tOK: 200,\n\tCREATED: 201,\n\tACCEPTED: 202,\n\tNON_AUTHORITATIVE_INFORMATION: 203,\n\tNO_CONTENT: 204,\n\tRESET_CONTENT: 205,\n\tPARTIAL_CONTENT: 206,\n\tMULTI_STATUS: 207,\n\tALREADY_REPORTED: 208,\n\tIM_USED: 226,\n\n\t// 3xx Redirection\n\tMULTIPLE_CHOICES: 300,\n\tMOVED_PERMANENTLY: 301,\n\tFOUND: 302,\n\tSEE_OTHER: 303,\n\tNOT_MODIFIED: 304,\n\tUSE_PROXY: 305,\n\tTEMPORARY_REDIRECT: 307,\n\tPERMANENT_REDIRECT: 308,\n\n\t// 4xx Client Error\n\tBAD_REQUEST: 400,\n\tUNAUTHORIZED: 401,\n\tPAYMENT_REQUIRED: 402,\n\tFORBIDDEN: 403,\n\tNOT_FOUND: 404,\n\tMETHOD_NOT_ALLOWED: 405,\n\tNOT_ACCEPTABLE: 406,\n\tPROXY_AUTHENTICATION_REQUIRED: 407,\n\tREQUEST_TIMEOUT: 408,\n\tCONFLICT: 409,\n\tGONE: 410,\n\tLENGTH_REQUIRED: 411,\n\tPRECONDITION_FAILED: 412,\n\tPAYLOAD_TOO_LARGE: 413,\n\tURI_TOO_LONG: 414,\n\tUNSUPPORTED_MEDIA_TYPE: 415,\n\tRANGE_NOT_SATISFIABLE: 416,\n\tEXPECTATION_FAILED: 417,\n\tIM_A_TEAPOT: 418,\n\tMISDIRECTED_REQUEST: 421,\n\tUNPROCESSABLE_ENTITY: 422,\n\tLOCKED: 423,\n\tFAILED_DEPENDENCY: 424,\n\tTOO_EARLY: 425,\n\tUPGRADE_REQUIRED: 426,\n\tPRECONDITION_REQUIRED: 428,\n\tTOO_MANY_REQUESTS: 429,\n\tREQUEST_HEADER_FIELDS_TOO_LARGE: 431,\n\tUNAVAILABLE_FOR_LEGAL_REASONS: 451,\n\n\t// 5xx Server Error\n\tINTERNAL_SERVER_ERROR: 500,\n\tNOT_IMPLEMENTED: 501,\n\tBAD_GATEWAY: 502,\n\tSERVICE_UNAVAILABLE: 503,\n\tGATEWAY_TIMEOUT: 504,\n\tHTTP_VERSION_NOT_SUPPORTED: 505,\n\tVARIANT_ALSO_NEGOTIATES: 506,\n\tINSUFFICIENT_STORAGE: 507,\n\tLOOP_DETECTED: 508,\n\tNOT_EXTENDED: 510,\n\tNETWORK_AUTHENTICATION_REQUIRED: 511,\n};","/** biome-ignore-all lint/style/noNonNullAssertion: <'explanation'> */\n/** biome-ignore-all lint/suspicious/noExplicitAny: <\"explanation\"> */\n\ntype Listener<T extends Array<any>> = (...args: T) => void;\n\nexport class EventEmitter<EventMap extends Record<string, Array<any>>> {\n\tprivate eventListeners: {\n\t\t[K in keyof EventMap]?: Set<Listener<EventMap[K]>>;\n\t} = {};\n\n\ton<K extends keyof EventMap>(eventName: K, listener: Listener<EventMap[K]>) {\n\t\tconst listeners = this.eventListeners[eventName] ?? new Set();\n\t\tlisteners.add(listener);\n\t\tthis.eventListeners[eventName] = listeners;\n\t}\n\n\temit<K extends keyof EventMap>(eventName: K, ...args: EventMap[K]) {\n\t\tconst listeners = this.eventListeners[eventName];\n\t\tfor (const listener of listeners!) {\n\t\t\tlistener(...args);\n\t\t}\n\t}\n}\n","import chalk from \"chalk\";\nimport signale from \"signale\";\nimport { EventEmitter } from \"./eventemitter.config.ts\";\n\nconst METHOD_WIDTH = 6;\nconst STATUS_WIDTH = 6;\nconst PATH_WIDTH = 10;\n\nfunction pad(value: string, width: number) {\n\treturn value.length >= width\n\t\t? value.slice(0, width)\n\t\t: value.padEnd(width, \" \");\n}\n\nfunction colorStatus(status: number) {\n\tif (status >= 500) return chalk.red(status);\n\tif (status >= 400) return chalk.yellow(status);\n\tif (status >= 300) return chalk.cyan(status);\n\treturn chalk.green(status);\n}\n\nfunction colorDuration(ms: number) {\n\tif (ms > 1000) return chalk.red(`${ms.toFixed(3)}ms`);\n\tif (ms > 500) return chalk.yellow(`${ms.toFixed(3)}ms`);\n\treturn chalk.grey(`${ms.toFixed(3)}ms`);\n}\n\ntype EventMap = {\n\t\"api:log\": [\n\t\tstartTime: number,\n\t\troutePath: string | undefined,\n\t\tmethod: string | undefined,\n\t\tstatus: number,\n\t];\n};\n\nconst apiEventLog = new EventEmitter<EventMap>();\n// log user activity\n\napiEventLog.on(\n\t\"api:log\",\n\t(\n\t\tstartTime: number,\n\t\troutePath: string | undefined,\n\t\tmethod: string | undefined,\n\t\tstatus: number,\n\t) => {\n\t\tconst duration = performance.now() - startTime;\n\n\t\tconst methodCol = pad(method?.toUpperCase() ?? \"GET\", METHOD_WIDTH);\n\t\tconst statusCol = pad(status.toString(), STATUS_WIDTH);\n\t\tconst pathCol = pad(routePath ?? \"/\", PATH_WIDTH);\n\n\t\tsignale.log(\n\t\t\tchalk.bold(methodCol),\n\t\t\tcolorStatus(Number(statusCol)),\n\t\t\tpathCol,\n\t\t\tcolorDuration(duration),\n\t\t);\n\t},\n);\n\nexport { apiEventLog };\n","import type { IncomingMessage } from \"node:http\";\n\n\nexport default async function Parse(req: IncomingMessage) : Promise<any> {\n    return new Promise((resolve, reject) => {\n        let body = ''\n        req.on('data', (chunk) => {\n            body += chunk.toString()\n        })\n    \n        req.on('end', () => {\n            resolve(JSON.parse(body))\n\n        })\n    })       \n}","\nimport { HTTP_STATUS } from \"../constants/httpStatus.constants\";\nimport { apiEventLog } from \"../events/apiEventLog.event\";\nimport type { Middleware, Request, Response } from \"../types/network\";\nexport function runMiddlewares(\n  {\n    middlewares,\n    req, \n    res,\n    onRunRoute\n  }: {\n    middlewares: Middleware[],\n    req: Request,\n    res: Response,\n    onRunRoute: (req: Request, res: Response) => any}\n  ) {\n    let index = 0;\n    let finished = false;\n  \n    function next(err?: unknown) {\n      // Prevent double execution\n      if (finished) return;\n  \n      // Error handling\n      if (err) {\n        console.log(err)\n        finished = true;\n        res.end(JSON.stringify({message: 'error'}))\n        // TODO: error handler\n        // handleError(err, req, res);\n        res.writeHead(HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        res.end(JSON.stringify({message: 'Internal Server Error'}));\n        apiEventLog.emit(\n          \"api:log\",\n          req.__meta.startTime,\n          req.url,\n          req.method,\n          HTTP_STATUS.INTERNAL_SERVER_ERROR,\n        );\n        return;\n      }\n  \n      // Stop if response already ended\n      if (res.writableEnded) {\n        apiEventLog.emit(\n          \"api:log\",\n          req.__meta.startTime,\n          req.url,\n          req.method,\n          res.statusCode,\n        );\n        finished = true;\n        return;\n      }\n  \n      const middleware = middlewares[index++];\n      \n      if (!middleware) {\n        finished = true;\n        try {\n          onRunRoute(req, res)\n        } catch(_: unknown) {\n          res.writeHead(HTTP_STATUS.INTERNAL_SERVER_ERROR);\n          res.end(JSON.stringify({message: 'Internal Server Error'}));\n          apiEventLog.emit(\n            \"api:log\",\n            req.__meta.startTime,\n            req.url,\n            req.method,\n            HTTP_STATUS.INTERNAL_SERVER_ERROR,\n          );\n        } \n        return;\n      }\n\n\n\n  \n      try {\n\n        const result: any = middleware.handler({\n          req: req, \n          res: res, \n          next: next\n        });\n        \n        // Handle async middleware\n        if (result instanceof Promise) {\n          result.catch(next);\n        }\n      } catch (error) {\n        next(error);\n      }\n    }\n  \n    next();\n  }","/** biome-ignore-all lint/suspicious/noExplicitAny: <'explanation'> */\nimport type { ServerResponse } from \"node:http\";\nimport { HTTP_STATUS } from \"../constants/httpStatus.constants\";\nimport { apiEventLog } from \"../events/apiEventLog.event\";\nimport type { Request, Route } from \"../types/network\";\nimport Parse from \"../utils/body-parser\";\nimport { runMiddlewares } from \"../utils/runMiddleware\";\nimport { runRoute } from \"../utils/utils\";\n\nexport default async function handleServer({\n\treq,\n\tres,\n\troutes,\n}: {\n\treq: Request;\n\tres: ServerResponse;\n\troutes: Array<Route>;\n}) {\n\t/**\n\t * * Getting The Request Start Time\n\t */\n    (req as any).__meta ??= {}\n\tconst requestStartTime = performance.now();\n\treq.__meta.startTime = requestStartTime;\n\t/**\n\t ** -----------------------------------\n\t ** -----------------------------------\n\t */\n\n\tconst matchingRoutes = routes.filter((e) => req.url?.startsWith(e.baseRoute));\n\n\tif (!matchingRoutes.length) {\n\t\tres.writeHead(HTTP_STATUS.NOT_FOUND, {\n\t\t\t\"content-type\": \"application/json\",\n\t\t});\n\t\tapiEventLog.emit(\n\t\t\t\"api:log\",\n\t\t\treq.__meta.startTime,\n\t\t\treq.url,\n\t\t\treq.method,\n\t\t\tHTTP_STATUS.NOT_FOUND,\n\t\t);\n\t\treturn res.end(\n\t\t\tJSON.stringify({\n\t\t\t\tmessage: \"Route Not Found\",\n\t\t\t}),\n\t\t);\n\t}\n\n\tfor (const route of matchingRoutes) {\n\t\tfor (const subRoute of route.subRoutes) {\n\t\t\tif (\n\t\t\t\treq.url === `${route.baseRoute}${subRoute.path}` &&\n\t\t\t\treq.method?.toLocaleLowerCase() ===\n\t\t\t\t\tsubRoute.method.toLocaleLowerCase().trim()\n\t\t\t) {\n\t\t\t\tlet body = {};\n\t\t\t\tif ([\"post\", \"patch\", \"put\"].includes(req.method.toLocaleLowerCase())) {\n\t\t\t\t\tbody = await Parse(req);\n\t\t\t\t\treq.body = body;\n\t\t\t\t}\n\n\t\t\t\trunMiddlewares({\n\t\t\t\t\tmiddlewares: subRoute.middlewares.reverse(),\n\t\t\t\t\treq,\n\t\t\t\t\tres,\n\t\t\t\t\tonRunRoute: async (req, res) => {\n\t\t\t\t\t\tawait runRoute({\n\t\t\t\t\t\t\tfilePath: `${route.filePath}/+route.ts`,\n\t\t\t\t\t\t\thandlerKey: subRoute.handlerKey,\n\t\t\t\t\t\t\treq,\n\t\t\t\t\t\t\tres,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n","/** biome-ignore-all lint/suspicious/useIterableCallbackReturn: <'explanation'> */\n/** biome-ignore-all lint/style/noNonNullAssertion: <'explanation'> */\n\nimport { createServer } from \"node:http\";\nimport { Chalk } from \"chalk\";\nimport signale from \"signale\";\nimport type { Config } from \"../types/config.t\";\nimport type { Route } from \"../types/network\";\nimport {\n\tcheckRoutes,\n\tgetDirectoryPathsRecursive,\n\tisPortAvailable,\n\tprocessRoutes,\n} from \"../utils/utils\";\nimport handleServer from \"./handleServer\";\n\nexport function Server() {\n\tlet nConfig: Config;\n\n\treturn {\n\t\tconfig: (config: Config) => {\n\t\t\tnConfig = config;\n\t\t},\n\t\tserve: async (callback?: () => void) => {\n\t\t\tconst chalk = new Chalk();\n\t\t\tconst bootTime = Date.now();\n\t\t\t// const BASE_PATH = `${appRootPath.path}/src/routes`\n\t\t\tconst packageRoot = nConfig.root;\n\t\t\tconst BASE_PATH = `${packageRoot}/src/routes`;\n\t\t\tconst routes: Array<Route> = [];\n\t\t\tconst portInUse = await isPortAvailable(nConfig.port);\n\t\t\t/**\n\t\t\t * Checking if port is available for use and failing early\n\t\t\t */\n\t\t\tif (portInUse.isInUse) {\n\t\t\t\tsignale.error(\"Port is already in use by another process.\");\n\t\t\t\tprocess.exit(1);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * * Getting ip addresss and printing ports\n\t\t\t */\n\n\t\t\tconst ip = await import(\"ip\");\n\n\t\t\tconst localLabel = \"Local: \".padEnd(10);   // \"Local:    \"\n\t\t\tconst networkLabel = \"Network: \".padEnd(10); // \"Network:  \"\n\n\t\t\tsignale.log(`\\n${localLabel}`, `http://localhost:${nConfig.port}`);\n\t\t\tsignale.log(networkLabel, `http://${ip.address()}:${nConfig.port}\\n`);\n\t\t\t\t\t\t/**\n\t\t\t * Checking Route Directories\n\t\t\t */\n\t\t\tconst dirs = await getDirectoryPathsRecursive(BASE_PATH);\n\n\t\t\tif (!dirs.length) {\n\t\t\t\tsignale.error(\n\t\t\t\t\t\"Routes Not Found:\",\n\t\t\t\t\t\"Please add +routes files in ./src/routes/<base-route>/+route\",\n\t\t\t\t);\n\t\t\t\tprocess.exit(1);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Process\n\t\t\t */\n\t\t\tfor (const dir of dirs) {\n\t\t\t\tconst route: string = dir.split(\"src/routes\")[1] ?? \"/\";\n\t\t\t\tconst baseRoute = route.replace(\"[id]\", \":id\");\n\t\t\t\troutes.push({\n\t\t\t\t\tbaseRoute,\n\t\t\t\t\tsubRoutes: [],\n\t\t\t\t\tfilePath: dir,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Checking if routes are valid\n\t\t\t */\n\t\t\tfor (const route of routes) {\n\t\t\t\tcheckRoutes(`${route.filePath}/+route.ts`);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Processing Routes\n\t\t\t * Adds Middleware to Routes from Decorators (if any)\n\t\t\t */\n\t\t\tawait Promise.all(\n\t\t\t\troutes.map(async (e, index) => {\n\t\t\t\t\tconst pResult = await processRoutes(`${e.filePath}/+route.ts`);\n\t\t\t\t\troutes[index]!.subRoutes = pResult ?? [];\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tconst server = createServer(async (req: any, res) => {\n\t\t\t\t/**\n\t\t\t\t * All server events handler\n\t\t\t\t */\n\t\t\t\thandleServer({\n\t\t\t\t\treq,\n\t\t\t\t\tres,\n\t\t\t\t\troutes,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tserver.listen(nConfig.port, \"0.0.0.0\", async () => {\n\t\t\t\tif (callback !== undefined) {\n\t\t\t\t\tcallback();\n\t\t\t\t} else {\n\t\t\t\t\tconst startTime = Date.now();\n\t\t\t\t\tconst bootDuration = ((startTime - bootTime) / 1000).toFixed(2);\n\t\t\t\t\tsignale.info(chalk.yellow(\"Booting Up...\"));\n\t\t\t\t\tsignale.success(`Server is ready! (${bootDuration}s)`, '\\n\\n');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t};\n}\n","// utils/controller-handler.ts\nimport { HTTP_STATUS } from \"../constants/httpStatus.constants.ts\";\nimport { apiEventLog } from \"../events/apiEventLog.event.ts\";\nimport type { Context, Request, Response } from \"../types/network.ts\";\n// import { mapErrorToResponse } from \"./error.mapper.ts\";\n\n/**\n * Generic controller wrapper.\n * Allows per-handler status codes and custom error handling.\n */\nexport function controllerHandler<T = unknown>(\n\thandler: (ctx: Context) => Promise<T>,\n\toptions?: {\n\t\tsuccessStatus?: number; // Custom success HTTP status\n\t\ttransform?: (data: T) => unknown; // Optional response data transformer\n\t\tonError?: (error: unknown, req: Request, res: Response) => unknown; // Custom error handler\n\t},\n) {\n\treturn async (req: Request, res: Response) => {\n\t\ttry {\n\t\t\tconst result = await handler({\n\t\t\t\treq: req,\n\t\t\t\tres: res,\n\t\t\t});\n\t\t\tconst transformed = options?.transform\n\t\t\t\t? options.transform(result)\n\t\t\t\t: result;\n\n\t\t\t// Custom success status (defaults to 200)\n\t\t\tconst status = options?.successStatus ?? 200;\n\t\t\tres.writeHead(status);\n\t\t\tres.end(JSON.stringify(transformed));\n\t\t\tapiEventLog.emit(\n\t\t\t\t\"api:log\",\n\t\t\t\treq.__meta.startTime,\n\t\t\t\treq.url,\n\t\t\t\treq.method,\n\t\t\t\tstatus,\n\t\t\t);\n            return\n\t\t} catch (_: unknown) {\n\t\t\tres.writeHead(HTTP_STATUS.INTERNAL_SERVER_ERROR);\n\t\t\tres.end(JSON.stringify({message: 'Internal Server Error'}));\n\t\t\tapiEventLog.emit(\n\t\t\t\t\"api:log\",\n\t\t\t\treq.__meta.startTime,\n\t\t\t\treq.url,\n\t\t\t\treq.method,\n\t\t\t\tHTTP_STATUS.INTERNAL_SERVER_ERROR,\n\t\t\t);\n\t\t\treturn\n\t\t}\n\t};\n}\n"],"mappings":"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"}